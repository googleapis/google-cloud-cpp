// Copyright 2024 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      https://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Generated by the C++ microgenerator.
// If you make any local changes, they will be lost.
// file:///workspace/generator/discovery/compute_public_google_rest_v1.json
// revision: 20241112

syntax = "proto3";

package google.cloud.cpp.compute.v1;

import "google/cloud/compute/v1/internal/common_003.proto";

// A transient resource used in compute.instances.bulkInsert and
// compute.regionInstances.bulkInsert . This resource is not persisted anywhere,
// it is used only for processing the requests.
message BulkInsertInstanceResource {
  // The maximum number of instances to create.
  optional string count = 1 [json_name = "count"];

  // The instance properties defining the VM instances to be created. Required
  // if sourceInstanceTemplate is not provided.
  optional InstanceProperties instance_properties = 2
      [json_name = "instanceProperties"];

  // Policy for choosing target zone. For more information, see Create VMs in
  // bulk.
  optional LocationPolicy location_policy = 3 [json_name = "locationPolicy"];

  // The minimum number of instances to create. If no min_count is specified
  // then count is used as the default value. If min_count instances cannot be
  // created, then no instances will be created and instances already created
  // will be deleted.
  optional string min_count = 4 [json_name = "minCount"];

  // The string pattern used for the names of the VMs. Either name_pattern or
  // per_instance_properties must be set. The pattern must contain one
  // continuous sequence of placeholder hash characters (#) with each character
  // corresponding to one digit of the generated instance name. Example: a
  // name_pattern of inst-#### generates instance names such as inst-0001 and
  // inst-0002. If existing instances in the same project and zone have names
  // that match the name pattern then the generated instance numbers start after
  // the biggest existing number. For example, if there exists an instance with
  // name inst-0050, then instance names generated using the pattern inst-####
  // begin with inst-0051. The name pattern placeholder #...# can contain up to
  // 18 characters.
  optional string name_pattern = 5 [json_name = "namePattern"];

  // Per-instance properties to be set on individual instances. Keys of this map
  // specify requested instance names. Can be empty if name_pattern is used.
  map<string, BulkInsertInstanceResourcePerInstanceProperties>
      per_instance_properties = 6 [json_name = "perInstanceProperties"];

  // Specifies the instance template from which to create instances. You may
  // combine sourceInstanceTemplate with instanceProperties to override specific
  // values from an existing instance template. Bulk API follows the semantics
  // of JSON Merge Patch described by RFC 7396. It can be a full or partial URL.
  // For example, the following are all valid URLs to an instance template: -
  // https://www.googleapis.com/compute/v1/projects/project
  // /global/instanceTemplates/instanceTemplate -
  // projects/project/global/instanceTemplates/instanceTemplate -
  // global/instanceTemplates/instanceTemplate This field is optional.
  optional string source_instance_template = 7
      [json_name = "sourceInstanceTemplate"];
}

// Per-instance properties to be set on individual instances. To be extended in
// the future.
message BulkInsertInstanceResourcePerInstanceProperties {
  // Specifies the hostname of the instance. More details in:
  // https://cloud.google.com/compute/docs/instances/custom-hostname-vm#naming_convention
  optional string hostname = 2 [json_name = "hostname"];

  // This field is only temporary. It will be removed. Do not use it.
  optional string name = 1 [json_name = "name"];
}

// Configuration for location policy among multiple possible locations (e.g.
// preferences for zone selection among zones in a single region).
message LocationPolicy {
  // Location configurations mapped by location name. Currently only zone names
  // are supported and must be represented as valid internal URLs, such as
  // zones/us-central1-a.
  map<string, LocationPolicyLocation> locations = 1 [json_name = "locations"];

  // Strategy for distributing VMs across zones in a region.
  // ANY: GCE picks zones for creating VM instances to fulfill the requested
  // number of VMs within present resource constraints and to maximize
  // utilization of unused zonal reservations. Recommended for batch workloads
  // that do not require high availability.
  // ANY_SINGLE_ZONE: GCE always selects a single zone for all the VMs,
  // optimizing for resource quotas, available reservations and general
  // capacity. Recommended for batch workloads that cannot tollerate
  // distribution over multiple zones. This the default shape in Bulk Insert and
  // Capacity Advisor APIs.
  // BALANCED: GCE prioritizes acquisition of resources, scheduling VMs in zones
  // where resources are available while distributing VMs as evenly as possible
  // across allowed zones to minimize the impact of zonal failure. Recommended
  // for highly available serving workloads.
  optional string target_shape = 2 [json_name = "targetShape"];
}

message LocationPolicyLocation {
  // Constraints that the caller requires on the result distribution in this
  // zone.
  optional LocationPolicyLocationConstraints constraints = 1
      [json_name = "constraints"];

  // Preference for a given location. Set to either ALLOW or DENY.
  // ALLOW: Location is allowed for use.
  // DENY: Location is prohibited.
  // PREFERENCE_UNSPECIFIED: Default value, unused.
  optional string preference = 2 [json_name = "preference"];
}

// Per-zone constraints on location policy for this zone.
message LocationPolicyLocationConstraints {
  // Maximum number of items that are allowed to be placed in this zone. The
  // value must be non-negative.
  optional int32 max_count = 1 [json_name = "maxCount"];
}
