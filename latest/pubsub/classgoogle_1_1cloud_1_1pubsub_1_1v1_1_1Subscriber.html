<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google Cloud Pub/Sub C++ Client: google::cloud::pubsub::v1::Subscriber Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Google Cloud Pub/Sub C++ Client
   &#160;<span id="projectnumber">1.27.0</span>
   </div>
   <div id="projectbrief">A C++ Client Library for Google Cloud Pub/Sub</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegoogle.html">google</a></li><li class="navelem"><a class="el" href="namespacegoogle_1_1cloud.html">cloud</a></li><li class="navelem"><a class="el" href="namespacegoogle_1_1cloud_1_1pubsub.html">pubsub</a></li><li class="navelem"><a class="el" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html">v1</a></li><li class="navelem"><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html">Subscriber</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">google::cloud::pubsub::v1::Subscriber Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Receive messages from the Cloud Pub/Sub service.  
 <a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="subscriber_8h_source.html">google/cloud/pubsub/subscriber.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2475af1f53fa45304228aeb6b79027fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html#a2475af1f53fa45304228aeb6b79027fa">Subscriber</a> (std::shared_ptr&lt; <a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberConnection.html">SubscriberConnection</a> &gt; connection)</td></tr>
<tr class="separator:a2475af1f53fa45304228aeb6b79027fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1cc9e1d2af829a9864589d3e0b87241"><td class="memTemplParams" colspan="2">template&lt;typename Callable &gt; </td></tr>
<tr class="memitem:af1cc9e1d2af829a9864589d3e0b87241"><td class="memTemplItemLeft" align="right" valign="top">future&lt; Status &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html#af1cc9e1d2af829a9864589d3e0b87241">Subscribe</a> (Callable &amp;&amp;cb)</td></tr>
<tr class="memdesc:af1cc9e1d2af829a9864589d3e0b87241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new session to receive messages from <code>subscription</code>.  <a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html#af1cc9e1d2af829a9864589d3e0b87241">More...</a><br /></td></tr>
<tr class="separator:af1cc9e1d2af829a9864589d3e0b87241"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Receive messages from the Cloud Pub/Sub service. </p>
<p>This class is used to receive message from a given subscription, with a fixed configuration such as credentials, and background threads. Applications that receive messages from multiple subscriptions need to create separate instances of this class. Applications wanting to receive events with configuration parameters also need to create separate instances.</p>
<dl class="section see"><dt>See also</dt><dd><a href="https://cloud.google.com/pubsub">https://cloud.google.com/pubsub</a> for an overview of the Cloud Pub/Sub service.</dd></dl>
<dl class="section user"><dt>Example: subscriber quickstart</dt><dd><div class="fragment"><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">pubsub</a> = <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">google::cloud::pubsub</a>;</div>
<div class="line">  <span class="keyword">auto</span> sample = [](<a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html">pubsub::Subscriber</a> subscriber) {</div>
<div class="line">    <span class="keywordflow">return</span> subscriber.Subscribe(</div>
<div class="line">        [&amp;](<a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Message.html">pubsub::Message</a> <span class="keyword">const</span>&amp; m, <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler.html">pubsub::AckHandler</a> h) {</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;Received message &quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">          std::move(h).ack();</div>
<div class="line">          PleaseIgnoreThisSimplifiesTestingTheSamples();</div>
<div class="line">        });</div>
<div class="line">  };</div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Performance</dt><dd><code><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html" title="Receive messages from the Cloud Pub/Sub service.">Subscriber</a></code> objects are relatively cheap to create, copy, and move. However, each <code><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html" title="Receive messages from the Cloud Pub/Sub service.">Subscriber</a></code> object must be created with a <code>std::shared_ptr&lt;<a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberConnection.html" title="A connection to the Cloud Pub/Sub service to receive events.">SubscriberConnection</a>&gt;</code>, which itself is relatively expensive to create. Therefore, connection instances should be shared when possible. See the <code><a class="el" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a4d36a0acd0c273b491563d99b7f370fb" title="Creates a new SubscriberConnection object to work with Subscriber.">MakeSubscriberConnection()</a></code> function and the <code><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberConnection.html" title="A connection to the Cloud Pub/Sub service to receive events.">SubscriberConnection</a></code> interface for more details.</dd></dl>
<dl class="section user"><dt>Thread Safety</dt><dd>Instances of this class created via copy-construction or copy-assignment share the underlying pool of connections. Access to these copies via multiple threads is guaranteed to work. Two threads operating on the same instance of this class is not guaranteed to work.</dd></dl>
<dl class="section user"><dt>Background Threads</dt><dd>This class uses the background threads configured via <code>ConnectionOptions</code>. Applications can create their own pool of background threads by (a) creating their own <a class="elRef" href="https://googleapis.dev/cpp/google-cloud-common/latest/classgoogle_1_1cloud_1_1v1_1_1CompletionQueue.html">google::cloud::v1::CompletionQueue</a>, (b) setting this completion queue in <code>pubsub::ConnectionOptions::DisableBackgroundThreads()</code>, and (c) attaching any number of threads to the completion queue.</dd></dl>
<dl class="section user"><dt>Example: using a custom thread pool</dt><dd><div class="fragment"><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">pubsub</a> = <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">google::cloud::pubsub</a>;</div>
<div class="line">  <span class="keyword">using</span> google::cloud::future;</div>
<div class="line">  <span class="keyword">using</span> google::cloud::StatusOr;</div>
<div class="line">  [](std::string project_id, std::string subscription_id) {</div>
<div class="line">    <span class="comment">// Create our own completion queue to run the background activity.</span></div>
<div class="line">    google::cloud::CompletionQueue cq;</div>
<div class="line">    <span class="comment">// Setup one or more of threads to service this completion queue. These must</span></div>
<div class="line">    <span class="comment">// remain running until all the work is done.</span></div>
<div class="line">    std::vector&lt;std::thread&gt; tasks;</div>
<div class="line">    std::generate_n(std::back_inserter(tasks), 4, [&amp;cq] {</div>
<div class="line">      <span class="keywordflow">return</span> std::thread([cq]() <span class="keyword">mutable</span> { cq.Run(); });</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> subscriber = <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html">pubsub::Subscriber</a>(<a class="code" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a4d36a0acd0c273b491563d99b7f370fb">pubsub::MakeSubscriberConnection</a>(</div>
<div class="line">        <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscription.html">pubsub::Subscription</a>(std::move(project_id), std::move(subscription_id)),</div>
<div class="line">        <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberOptions.html">pubsub::SubscriberOptions</a>{},</div>
<div class="line">        <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a6833bef0c593e2cfde6e1c9f2d745b94">pubsub::ConnectionOptions</a>{}.DisableBackgroundThreads(cq)));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Because this is an example we want to exit eventually, use a mutex and</span></div>
<div class="line">    <span class="comment">// condition variable to notify the current thread and stop the example.</span></div>
<div class="line">    std::mutex mu;</div>
<div class="line">    std::condition_variable cv;</div>
<div class="line">    <span class="keywordtype">int</span> count = 0;</div>
<div class="line">    <span class="keyword">auto</span> await_count = [&amp;] {</div>
<div class="line">      std::unique_lock&lt;std::mutex&gt; lk(mu);</div>
<div class="line">      cv.wait(lk, [&amp;] { <span class="keywordflow">return</span> count &gt;= 4; });</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> increase_count = [&amp;] {</div>
<div class="line">      std::unique_lock&lt;std::mutex&gt; lk(mu);</div>
<div class="line">      <span class="keywordflow">if</span> (++count &gt;= 4) cv.notify_one();</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Receive messages in the previously allocated thread pool.</span></div>
<div class="line">    <span class="keyword">auto</span> session = subscriber.Subscribe(</div>
<div class="line">        [&amp;](<a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Message.html">pubsub::Message</a> <span class="keyword">const</span>&amp; m, <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler.html">pubsub::AckHandler</a> h) {</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;Received message &quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">          increase_count();</div>
<div class="line">          std::move(h).ack();</div>
<div class="line">        });</div>
<div class="line">    await_count();</div>
<div class="line">    session.cancel();</div>
<div class="line">    <span class="comment">// Report any final status, blocking until the subscription loop completes,</span></div>
<div class="line">    <span class="comment">// either with a failure or because it was canceled.</span></div>
<div class="line">    <span class="keyword">auto</span> status = session.get();</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Message count=&quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot;, status=&quot;</span> &lt;&lt; status &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Shutdown the completion queue and join the threads</span></div>
<div class="line">    cq.Shutdown();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : tasks) <a class="codeRef" href="https://googleapis.dev/cpp/google-cloud-common/latest/log_8cc.html#abc5627fb346314b5f14b10bdb6542da7">t</a>.join();</div>
<div class="line">  }</div>
</div><!-- fragment --> </dd></dl>
<dl class="section user"><dt>Asynchronous Functions</dt><dd>Some of the member functions in this class return a <code>future&lt;T&gt;</code> (or <code>future&lt;StatusOr&lt;T&gt;&gt;</code>) object. Readers are probably familiar with <a href="https://en.cppreference.com/w/cpp/thread/future"><code>std::future&lt;T&gt;</code></a>. Our version adds a <code>.then()</code> function to attach a callback to the future, which is invoked when the future is satisfied. This function returns a <code>future&lt;U&gt;</code> where <code>U</code> is the return value of the attached function. More details in the <a class="elRef" href="https://googleapis.dev/cpp/google-cloud-common/latest/classgoogle_1_1cloud_1_1v1_1_1future.html">google::cloud::v1::future</a> documentation.</dd></dl>
<dl class="section user"><dt>Error Handling</dt><dd>This class uses <code>StatusOr&lt;T&gt;</code> to report errors. When an operation fails to perform its work the returned <code>StatusOr&lt;T&gt;</code> contains the error details. If the <code>ok()</code> member function in the <code>StatusOr&lt;T&gt;</code> returns <code>true</code> then it contains the expected result. Please consult the <a class="elRef" href="https://googleapis.dev/cpp/google-cloud-common/latest/classgoogle_1_1cloud_1_1v1_1_1StatusOr.html">google::cloud::v1::StatusOr</a> documentation for more details.</dd></dl>
<dl class="section user"><dt>Changing Retry Parameters Example</dt><dd><div class="fragment"><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">pubsub</a> = <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">google::cloud::pubsub</a>;</div>
<div class="line">  <span class="keyword">using</span> google::cloud::future;</div>
<div class="line">  <span class="keyword">using</span> google::cloud::StatusOr;</div>
<div class="line">  <span class="keyword">auto</span> sample = [](std::string project_id, std::string subscription_id) {</div>
<div class="line">    <span class="comment">// By default a subscriber will retry for 60 seconds, with an initial</span></div>
<div class="line">    <span class="comment">// backoff of 100ms, a maximum backoff of 60 seconds, and the backoff will</span></div>
<div class="line">    <span class="comment">// grow by 30% after each attempt. This changes those defaults.</span></div>
<div class="line">    <span class="keyword">auto</span> subscriber = <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html">pubsub::Subscriber</a>(<a class="code" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a4d36a0acd0c273b491563d99b7f370fb">pubsub::MakeSubscriberConnection</a>(</div>
<div class="line">        <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscription.html">pubsub::Subscription</a>(std::move(project_id), std::move(subscription_id)),</div>
<div class="line">        <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberOptions.html">pubsub::SubscriberOptions</a>{}, <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a6833bef0c593e2cfde6e1c9f2d745b94">pubsub::ConnectionOptions</a>{},</div>
<div class="line">        <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a838db478485c19cba0f1e0e08ea30332">pubsub::LimitedTimeRetryPolicy</a>(</div>
<div class="line">            <span class="comment">/*maximum_duration=*/</span>std::chrono::minutes(1))</div>
<div class="line">            .clone(),</div>
<div class="line">        <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a953aa9b925add24a5704b8a15749fe47">pubsub::ExponentialBackoffPolicy</a>(</div>
<div class="line">            <span class="comment">/*initial_delay=*/</span>std::chrono::milliseconds(200),</div>
<div class="line">            <span class="comment">/*maximum_delay=*/</span>std::chrono::seconds(10),</div>
<div class="line">            <span class="comment">/*scaling=*/</span>2.0)</div>
<div class="line">            .clone()));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> session = subscriber.Subscribe(</div>
<div class="line">        [](<a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Message.html">pubsub::Message</a> <span class="keyword">const</span>&amp; m, <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler.html">pubsub::AckHandler</a> h) {</div>
<div class="line">          std::move(h).ack();</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;Received message &quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">          PleaseIgnoreThisSimplifiesTestingTheSamples();</div>
<div class="line">        });</div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(subscriber, std::move(session));</div>
<div class="line">  };</div>
</div><!-- fragment --></dd></dl>

<p class="definition">Definition at line <a class="el" href="subscriber_8h_source.html#l00089">89</a> of file <a class="el" href="subscriber_8h_source.html">subscriber.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2475af1f53fa45304228aeb6b79027fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2475af1f53fa45304228aeb6b79027fa">&#9670;&nbsp;</a></span>Subscriber()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">google::cloud::pubsub::v1::Subscriber::Subscriber </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberConnection.html">SubscriberConnection</a> &gt;&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="subscriber_8h_source.html#l00091">91</a> of file <a class="el" href="subscriber_8h_source.html">subscriber.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af1cc9e1d2af829a9864589d3e0b87241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1cc9e1d2af829a9864589d3e0b87241">&#9670;&nbsp;</a></span>Subscribe()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Callable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">future&lt;Status&gt; google::cloud::pubsub::v1::Subscriber::Subscribe </td>
          <td>(</td>
          <td class="paramtype">Callable &amp;&amp;&#160;</td>
          <td class="paramname"><em>cb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a new session to receive messages from <code>subscription</code>. </p>
<dl class="section note"><dt>Note</dt><dd>Callable must be <code>CopyConstructible</code>, as <code>cb</code> will be stored in a <a href="https://en.cppreference.com/w/cpp/utility/functional/function"><code>std::function&lt;&gt;</code></a>.</dd></dl>
<dl class="section user"><dt>Idempotency</dt><dd><p class="startdd">This is an idempotent operation; it only reads messages from the service. Will make multiple attempts to start a connection to the service, subject to the retry policies configured in the <code><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberConnection.html" title="A connection to the Cloud Pub/Sub service to receive events.">SubscriberConnection</a></code>. Once a successful connection is established the library will try to resume the connection even if the connection fails with a permanent error. Resuming the connection is subject to the retry policies as described earlier.</p>
<p class="enddd">Note that calling <code><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler.html#ae0cba314ccf75c7e6f048d3dfaec995b" title="Acknowledges the message associated with this handler.">AckHandler::ack()</a></code> and/or <code><a class="el" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler.html#af59d345070792526791429611e5a25c8" title="Rejects the message associated with this handler.">AckHandler::nack()</a></code> is handled differently with respect to retrying. Check the documentation of these functions for details. </p>
</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">pubsub</a> = <a class="code" href="namespacegoogle_1_1cloud_1_1pubsub.html">google::cloud::pubsub</a>;</div>
<div class="line">  <span class="keyword">auto</span> sample = [](<a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html">pubsub::Subscriber</a> subscriber) {</div>
<div class="line">    <span class="keywordflow">return</span> subscriber.Subscribe(</div>
<div class="line">        [&amp;](<a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Message.html">pubsub::Message</a> <span class="keyword">const</span>&amp; m, <a class="code" href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler.html">pubsub::AckHandler</a> h) {</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;Received message &quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">          std::move(h).ack();</div>
<div class="line">          PleaseIgnoreThisSimplifiesTestingTheSamples();</div>
<div class="line">        });</div>
<div class="line">  };</div>
</div><!-- fragment --> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>the callable invoked when messages are received. This must be usable to construct a <code>std::function&lt;void(pubsub::Message, pubsub::AckHandler)&gt;</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a future that is satisfied when the session will no longer receive messages. For example, because there was an unrecoverable error trying to receive data. Calling <code>.cancel()</code> in this object will (eventually) terminate the session and satisfy the future. </dd></dl>

<p class="definition">Definition at line <a class="el" href="subscriber_8h_source.html#l00129">129</a> of file <a class="el" href="subscriber_8h_source.html">subscriber.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="alog_8cc_html_abc5627fb346314b5f14b10bdb6542da7"><div class="ttname"><a href="https://googleapis.dev/cpp/google-cloud-common/latest/log_8cc.html#abc5627fb346314b5f14b10bdb6542da7">t</a></div><div class="ttdeci">absl::Time t</div></div>
<div class="ttc" id="aclassgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Message_html"><div class="ttname"><a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Message.html">google::cloud::pubsub::v1::Message</a></div><div class="ttdoc">The C++ representation for a Cloud Pub/Sub messages.</div><div class="ttdef"><b>Definition:</b> <a href="message_8h_source.html#l00078">message.h:78</a></div></div>
<div class="ttc" id="anamespacegoogle_1_1cloud_1_1pubsub_1_1v1_html_a6833bef0c593e2cfde6e1c9f2d745b94"><div class="ttname"><a href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a6833bef0c593e2cfde6e1c9f2d745b94">google::cloud::pubsub::v1::ConnectionOptions</a></div><div class="ttdeci">::google::cloud::ConnectionOptions&lt; ConnectionOptionsTraits &gt; ConnectionOptions</div><div class="ttdoc">Configure a connection for Cloud Pub/Sub services.</div><div class="ttdef"><b>Definition:</b> <a href="connection__options_8h_source.html#l00036">connection_options.h:37</a></div></div>
<div class="ttc" id="anamespacegoogle_1_1cloud_1_1pubsub_1_1v1_html_a953aa9b925add24a5704b8a15749fe47"><div class="ttname"><a href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a953aa9b925add24a5704b8a15749fe47">google::cloud::pubsub::v1::ExponentialBackoffPolicy</a></div><div class="ttdeci">google::cloud::internal::ExponentialBackoffPolicy ExponentialBackoffPolicy</div><div class="ttdoc">A truncated exponential backoff policy with randomized periods.</div><div class="ttdef"><b>Definition:</b> <a href="backoff__policy_8h_source.html#l00030">backoff_policy.h:31</a></div></div>
<div class="ttc" id="anamespacegoogle_1_1cloud_1_1pubsub_html"><div class="ttname"><a href="namespacegoogle_1_1cloud_1_1pubsub.html">google::cloud::pubsub</a></div><div class="ttdoc">Contains all the Cloud Pubsub C++ client types and functions.</div><div class="ttdef"><b>Definition:</b> <a href="ack__handler_8cc_source.html#l00020">ack_handler.cc:20</a></div></div>
<div class="ttc" id="aclassgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberOptions_html"><div class="ttname"><a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1SubscriberOptions.html">google::cloud::pubsub::v1::SubscriberOptions</a></div><div class="ttdoc">Configure how a Subscriber handles incoming messages.</div><div class="ttdef"><b>Definition:</b> <a href="subscriber__options_8h_source.html#l00080">subscriber_options.h:80</a></div></div>
<div class="ttc" id="anamespacegoogle_1_1cloud_1_1pubsub_1_1v1_html_a4d36a0acd0c273b491563d99b7f370fb"><div class="ttname"><a href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a4d36a0acd0c273b491563d99b7f370fb">google::cloud::pubsub::v1::MakeSubscriberConnection</a></div><div class="ttdeci">std::shared_ptr&lt; SubscriberConnection &gt; MakeSubscriberConnection(Subscription subscription, SubscriberOptions options, ConnectionOptions connection_options, std::unique_ptr&lt; pubsub::RetryPolicy const &gt; retry_policy, std::unique_ptr&lt; pubsub::BackoffPolicy const &gt; backoff_policy)</div><div class="ttdoc">Creates a new SubscriberConnection object to work with Subscriber.</div><div class="ttdef"><b>Definition:</b> <a href="subscriber__connection_8cc_source.html#l00041">subscriber_connection.cc:41</a></div></div>
<div class="ttc" id="aclassgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscription_html"><div class="ttname"><a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscription.html">google::cloud::pubsub::v1::Subscription</a></div><div class="ttdoc">Objects of this class identify a Cloud Pub/Sub subscription.</div><div class="ttdef"><b>Definition:</b> <a href="subscription_8h_source.html#l00037">subscription.h:37</a></div></div>
<div class="ttc" id="aclassgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber_html"><div class="ttname"><a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1Subscriber.html">google::cloud::pubsub::v1::Subscriber</a></div><div class="ttdoc">Receive messages from the Cloud Pub/Sub service.</div><div class="ttdef"><b>Definition:</b> <a href="subscriber_8h_source.html#l00089">subscriber.h:89</a></div></div>
<div class="ttc" id="aclassgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler_html"><div class="ttname"><a href="classgoogle_1_1cloud_1_1pubsub_1_1v1_1_1AckHandler.html">google::cloud::pubsub::v1::AckHandler</a></div><div class="ttdoc">Defines the interface to acknowledge and reject messages.</div><div class="ttdef"><b>Definition:</b> <a href="ack__handler_8h_source.html#l00048">ack_handler.h:48</a></div></div>
<div class="ttc" id="anamespacegoogle_1_1cloud_1_1pubsub_1_1v1_html_a838db478485c19cba0f1e0e08ea30332"><div class="ttname"><a href="namespacegoogle_1_1cloud_1_1pubsub_1_1v1.html#a838db478485c19cba0f1e0e08ea30332">google::cloud::pubsub::v1::LimitedTimeRetryPolicy</a></div><div class="ttdeci">google::cloud::internal::LimitedTimeRetryPolicy&lt; pubsub_internal::RetryTraits &gt; LimitedTimeRetryPolicy</div><div class="ttdoc">A retry policy that limits based on time.</div><div class="ttdef"><b>Definition:</b> <a href="retry__policy_8h_source.html#l00049">retry_policy.h:50</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
